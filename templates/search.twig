<div class="table-container">
	<div
		id="toolbar">
		<!-- Button trigger modal -->
		<button type="button" class="btn btn-secondary" onclick="populateModal()">
			<i class="fas fa-hammer text-white"></i>
		</button>
		<!-- Modal -->
		<div class="modal fade modal-lg" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<h1 class="modal-title fs-5" id="exampleModalLabel">{{"actions"|trans}}</h1>
						<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
					</div>
					<div class="modal-body">
						{{action_modalcontent|raw}}
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-primary">{{"save"|trans}}</button>
					</div>
				</div>
			</div>
		</div>
	</div>
	<table id="search-table" class="table table-striped table-bordered table-hover" data-toolbar="#toolbar" data-toggle="table" data-height="460" data-click-to-select="true" data-virtual-scroll="true" data-pagination="true" show-extended-pagination="true" data-search="true" data-sortable="true" data-show-export="true" data-buttons="buttons">
		<thead class="table-light">
			<tr>
				<th data-field="state" data-checkbox="true"></th>
				{% for field in fields %}
					<th data-sortable="true">{{ field['name'] }}</th>
				{% endfor %}
			</tr>
		</thead>
		<tbody>
			{% for value in values %}
				<tr>
					<td></td>
					{% for col in fields|keys %}
						<td>{{ value[col + 1] | raw }}</td>
					{% endfor %}
				</tr>
			{% endfor %}
		</tbody>
	</table>
</div>

<script>
	function populateModal() {
		$.ajax({
			type: "POST",
			url: "../ajax/massiveaction_ng.php",
			data: {
				'content': JSON.stringify($('#search-table').bootstrapTable('getSelections')),
				'item': {
					"{{itemtype}}": {
						'1': 1,
						'2': 0,
					},
				},
        	},
			success: function (data) {
				$('#exampleModal .modal-body').html(data);
			}
    	});
		$('#exampleModal').modal('show');
	}
	function buttons() {
		buttons = {
			btnAsMap: {
				text: 'Show as map',
				icon: 'fas fa-globe-europe',
				event: function () {
					console.log(this)
					console.log(JSON.stringify(this.getSelections()));
				},
				attributes: {
					title: {{ 'Show list as map'|trans|json_encode|raw }}
				}
			},
			btnshowTrash: {
				text: 'Show trash',
				icon: 'fas fa-trash-alt',
				event: function () {
				toogle('is_deleted', '', '', '');
				document.forms['searchform    {{ itemtype }}'].submit();
				},
				attributes: {
				title: {{ 'Show trash content'|trans|json_encode|raw }},

				style: {{ (is_trash == 1) ? 'background : #7b081d'|json_encode|raw : ''|json_encode|raw }}
				}
			}
		}
		if ('{{ searchConfigRights }}' === '1') {
			buttons.btnEditColumns = {
				text: 'Edit columns',
				icon: 'fas fa-wrench',
				event: function () {
					$('#search-config').dialog("open");
				},
				attributes: {
					title: {{ 'Edit columns position and content'|trans|json_encode|raw }}
				}
			}
		}
		console.log(buttons);
		return buttons;
}
</script>
<script src="https://unpkg.com/tableexport.jquery.plugin/tableExport.min.js"></script>
