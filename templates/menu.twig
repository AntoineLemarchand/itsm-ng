<nav class="nav-side-menu">

    <div class="menu-list">
  
        <ul id="menu-content" class="menu-content collapse out">

{% for menu_name, data in menu|filter(data => data['show_menu']) %}

            <li title="{{data['title']}}" id='menu-{{menu_name}}' class='menu {{data['class']}}' > {# loop.index starts at 1 mettre active bone page #}
                <div class="{{menu[menu_name]['is_open'] ?: 'collapsed'}} " onclick="openMenu(this, '{{menu_name}}')" data-toggle="collapse" data-target="#submenu-{{menu_name}}">
                    <i class="bubble-icon fas {{menu[menu_name]['icon']}}"></i>
                    <p>{{data['title']}}</p>
                    {% if menu_name == 'favorite' %}
                    <div id="menu-favorite-button" onclick="activateFavoriteMode(event)">
                        <i class="fas fa-cog"></i>
                    </div>
                    {% endif %}
                </div>


            
    {% if data['show_sub_menu'] %}

            <ul class="sub-menu ssmenu collapse {{menu[menu_name]['is_open'] ? 'show'}}" id='submenu-{{menu_name}}'>

        {% if menu_name == 'favorite' %}

                <p>You can add your favorite section to this menu. To do this click on the cogwheel then click and the star next to the menu you wish to add as a favorite.</p>
            {% for menu_name, data in menu|filter(data => data['show_menu']) %}
                {% for sub_menu_name,val in data['content']|filter(val => val['show_sub_menu']) %}
                    {% if val['is_favorite'] %}

                <li id='favorite-section-{{sub_menu_name}}' class="{{val['is_favorite'] ? 'section-favorite'}} {{menu[val['part']]['content'][sub_menu_name]['sub_menu_class']}}">
                    <a  href="{{root_doc}}{{val['page']}}" {{val['shortcut_attr']|raw}}>
                        <i class='submenu-icon fa-fw {{val['icon']}}'></i><p>{{val['title']}}</p>
                    </a>
                    <i class="star-icon" onclick="addFavorite(event, this, '{{menu_name}}', '{{sub_menu_name}}')">
                    </i>
                </li>

                    {% endif %}
                {% endfor %}
            {% endfor %}
        {% endif %}
        {% for sub_menu_name,val in data['content']|filter(val => val['show_sub_menu']) %}

                <li id='section-{{sub_menu_name}}' class="{{val['is_open'] ? 'show'}} {{val['is_favorite'] ? 'section-favorite'}} {{menu[val['part']]['content'][sub_menu_name]['sub_menu_class']}}">
                    <a  href="{{root_doc}}{{val['page']}}" {{val['shortcut_attr']|raw}} class="{{val['is_favorite'] ? 'section-favorite'}}">
                        <i class='submenu-icon fa-fw {{val['icon']}}'></i><p>{{val['title']}}</p>
                    </a>
                    <i class="star-icon" onclick="addFavorite(event, this, '{{menu_name}}', '{{sub_menu_name}}')">
                    </i>
                </li>

        {% endfor %}

            </ul>
        </li>
    {% endif %}
{% endfor %}

        </ul>
    </div>
</nav>